<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>Register</title>
	<link rel="stylesheet" href="{% static 'style.css' %}">
</head>
<body>
	<div class="container">
		<div class="card">
			<h1>Create your account</h1>
			<form method="post" action="">
				{% csrf_token %}
				<div class="field">
					<label for="id_username">Username</label>
					<input type="text" id="id_username" name="username" required minlength="3" maxlength="30" placeholder="Choose a username">
				</div>

				<div class="field">
					<label for="id_email">Email</label>
					<input type="email" id="id_email" name="email" required placeholder="you@example.com">
				</div>

				<div class="field password-field">
					<label for="id_password1">Password</label>
					<input type="password" id="id_password1" name="password1" required minlength="8" placeholder="Create a strong password">
					<button type="button" class="pw-toggle" aria-label="Toggle password visibility">Show</button>
				</div>

				<div class="field password-field">
					<label for="id_password2">Confirm Password</label>
					<input type="password" id="id_password2" name="password2" required placeholder="Repeat your password">
					<button type="button" class="pw-toggle" aria-label="Toggle password visibility">Show</button>
				</div>

				<div class="help" id="pw-help"></div>

				<button class="btn" type="submit">Register</button>
				<p class="muted">Already have an account? <a href="{% url 'login' %}">Sign in</a></p>
			</form>
		</div>
	</div>

	<script>
		document.addEventListener('DOMContentLoaded',function(){
			const p1 = document.getElementById('id_password1');
			const p2 = document.getElementById('id_password2');
			const help = document.getElementById('pw-help');
			const toggles = document.querySelectorAll('.pw-toggle');
			toggles.forEach(btn=>{
				btn.addEventListener('click',e=>{
					const input = btn.previousElementSibling;
					if(!input) return;
					if(input.type==='password'){ input.type='text'; btn.textContent='Hide'; }
					else{ input.type='password'; btn.textContent='Show'; }
				});
			});
			function validate(){
				if(p2.value && p1.value !== p2.value){
					help.textContent='Passwords do not match';
					help.classList.add('error');
					return false;
				}
				if(p2.value){
					help.textContent='';
					help.classList.remove('error');
				}
				return true;
			}
			p1.addEventListener('input',validate);
			p2.addEventListener('input',validate);
			document.querySelector('form').addEventListener('submit',function(e){
				if(!validate()){ e.preventDefault(); p2.focus(); }
			});
		});
	</script>
</body>
</html>
